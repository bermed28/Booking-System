{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.flip = flip;\n\nvar _convert = require(\"./convert\");\n\nvar _convert2 = _interopRequireDefault(_convert);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction reduce(node, precision) {\n  if (node.type === \"MathExpression\") return reduceMathExpression(node, precision);\n  if (node.type === \"Calc\") return reduce(node.value, precision);\n  return node;\n}\n\nfunction isEqual(left, right) {\n  return left.type === right.type && left.value === right.value;\n}\n\nfunction isValueType(type) {\n  switch (type) {\n    case 'LengthValue':\n    case 'AngleValue':\n    case 'TimeValue':\n    case 'FrequencyValue':\n    case 'ResolutionValue':\n    case 'EmValue':\n    case 'ExValue':\n    case 'ChValue':\n    case 'RemValue':\n    case 'VhValue':\n    case 'VwValue':\n    case 'VminValue':\n    case 'VmaxValue':\n    case 'PercentageValue':\n    case 'Value':\n      return true;\n  }\n\n  return false;\n}\n\nfunction convertMathExpression(node, precision) {\n  var nodes = (0, _convert2.default)(node.left, node.right, precision);\n  var left = reduce(nodes.left, precision);\n  var right = reduce(nodes.right, precision);\n\n  if (left.type === \"MathExpression\" && right.type === \"MathExpression\") {\n    if (left.operator === '/' && right.operator === '*' || left.operator === '-' && right.operator === '+' || left.operator === '*' && right.operator === '/' || left.operator === '+' && right.operator === '-') {\n      if (isEqual(left.right, right.right)) nodes = (0, _convert2.default)(left.left, right.left, precision);else if (isEqual(left.right, right.left)) nodes = (0, _convert2.default)(left.left, right.right, precision);\n      left = reduce(nodes.left, precision);\n      right = reduce(nodes.right, precision);\n    }\n  }\n\n  node.left = left;\n  node.right = right;\n  return node;\n}\n\nfunction flip(operator) {\n  return operator === '+' ? '-' : '+';\n}\n\nfunction flipValue(node) {\n  if (isValueType(node.type)) node.value = -node.value;else if (node.type == 'MathExpression') {\n    node.left = flipValue(node.left);\n    node.right = flipValue(node.right);\n  }\n  return node;\n}\n\nfunction reduceAddSubExpression(node, precision) {\n  var _node = node,\n      left = _node.left,\n      right = _node.right,\n      op = _node.operator;\n  if (left.type === 'CssVariable' || right.type === 'CssVariable') return node; // something + 0 => something\n  // something - 0 => something\n\n  if (right.value === 0) return left; // 0 + something => something\n\n  if (left.value === 0 && op === \"+\") return right; // 0 - something => -something\n\n  if (left.value === 0 && op === \"-\") return flipValue(right); // value + value\n  // value - value\n\n  if (left.type === right.type && isValueType(left.type)) {\n    node = Object.assign({}, left);\n    if (op === \"+\") node.value = left.value + right.value;else node.value = left.value - right.value;\n  } // value <op> (expr)\n\n\n  if (isValueType(left.type) && (right.operator === '+' || right.operator === '-') && right.type === 'MathExpression') {\n    // value + (value + something) => (value + value) + something\n    // value + (value - something) => (value + value) - something\n    // value - (value + something) => (value - value) - something\n    // value - (value - something) => (value - value) + something\n    if (left.type === right.left.type) {\n      node = Object.assign({}, node);\n      node.left = reduce({\n        type: 'MathExpression',\n        operator: op,\n        left: left,\n        right: right.left\n      }, precision);\n      node.right = right.right;\n      node.operator = op === '-' ? flip(right.operator) : right.operator;\n      return reduce(node, precision);\n    } // value + (something + value) => (value + value) + something\n    // value + (something - value) => (value - value) + something\n    // value - (something + value) => (value - value) - something\n    // value - (something - value) => (value + value) - something\n    else if (left.type === right.right.type) {\n      node = Object.assign({}, node);\n      node.left = reduce({\n        type: 'MathExpression',\n        operator: op === '-' ? flip(right.operator) : right.operator,\n        left: left,\n        right: right.right\n      }, precision);\n      node.right = right.left;\n      return reduce(node, precision);\n    }\n  } // (expr) <op> value\n\n\n  if (left.type === 'MathExpression' && (left.operator === '+' || left.operator === '-') && isValueType(right.type)) {\n    // (value + something) + value => (value + value) + something\n    // (value - something) + value => (value + value) - something\n    // (value + something) - value => (value - value) + something\n    // (value - something) - value => (value - value) - something\n    if (right.type === left.left.type) {\n      node = Object.assign({}, left);\n      node.left = reduce({\n        type: 'MathExpression',\n        operator: op,\n        left: left.left,\n        right: right\n      }, precision);\n      return reduce(node, precision);\n    } // (something + value) + value => something + (value + value)\n    // (something - value1) + value2 => something - (value2 - value1)\n    // (something + value) - value => something + (value - value)\n    // (something - value) - value => something - (value + value)\n    else if (right.type === left.right.type) {\n      node = Object.assign({}, left);\n\n      if (left.operator === '-') {\n        node.right = reduce({\n          type: 'MathExpression',\n          operator: op === '-' ? '+' : '-',\n          left: right,\n          right: left.right\n        }, precision);\n        node.operator = op === '-' ? '-' : '+';\n      } else {\n        node.right = reduce({\n          type: 'MathExpression',\n          operator: op,\n          left: left.right,\n          right: right\n        }, precision);\n      }\n\n      if (node.right.value < 0) {\n        node.right.value *= -1;\n        node.operator = node.operator === '-' ? '+' : '-';\n      }\n\n      return reduce(node, precision);\n    }\n  }\n\n  return node;\n}\n\nfunction reduceDivisionExpression(node, precision) {\n  if (!isValueType(node.right.type)) return node;\n  if (node.right.type !== 'Value') throw new Error(\"Cannot divide by \\\"\" + node.right.unit + \"\\\", number expected\");\n  if (node.right.value === 0) throw new Error('Cannot divide by zero'); // (expr) / value\n\n  if (node.left.type === 'MathExpression') {\n    if (isValueType(node.left.left.type) && isValueType(node.left.right.type)) {\n      node.left.left.value /= node.right.value;\n      node.left.right.value /= node.right.value;\n      return reduce(node.left, precision);\n    }\n\n    return node;\n  } // something / value\n  else if (isValueType(node.left.type)) {\n    node.left.value /= node.right.value;\n    return node.left;\n  }\n\n  return node;\n}\n\nfunction reduceMultiplicationExpression(node) {\n  // (expr) * value\n  if (node.left.type === 'MathExpression' && node.right.type === 'Value') {\n    if (isValueType(node.left.left.type) && isValueType(node.left.right.type)) {\n      node.left.left.value *= node.right.value;\n      node.left.right.value *= node.right.value;\n      return node.left;\n    }\n  } // something * value\n  else if (isValueType(node.left.type) && node.right.type === 'Value') {\n    node.left.value *= node.right.value;\n    return node.left;\n  } // value * (expr)\n  else if (node.left.type === 'Value' && node.right.type === 'MathExpression') {\n    if (isValueType(node.right.left.type) && isValueType(node.right.right.type)) {\n      node.right.left.value *= node.left.value;\n      node.right.right.value *= node.left.value;\n      return node.right;\n    }\n  } // value * something\n  else if (node.left.type === 'Value' && isValueType(node.right.type)) {\n    node.right.value *= node.left.value;\n    return node.right;\n  }\n\n  return node;\n}\n\nfunction reduceMathExpression(node, precision) {\n  node = convertMathExpression(node, precision);\n\n  switch (node.operator) {\n    case \"+\":\n    case \"-\":\n      return reduceAddSubExpression(node, precision);\n\n    case \"/\":\n      return reduceDivisionExpression(node, precision);\n\n    case \"*\":\n      return reduceMultiplicationExpression(node);\n  }\n\n  return node;\n}\n\nexports.default = reduce;","map":{"version":3,"sources":["/Users/bermed28/Desktop/booking-system-stackoverflowers-studios/frontend/node_modules/reduce-css-calc/dist/lib/reducer.js"],"names":["Object","defineProperty","exports","value","flip","_convert","require","_convert2","_interopRequireDefault","obj","__esModule","default","reduce","node","precision","type","reduceMathExpression","isEqual","left","right","isValueType","convertMathExpression","nodes","operator","flipValue","reduceAddSubExpression","_node","op","assign","reduceDivisionExpression","Error","unit","reduceMultiplicationExpression"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.flip = flip;\n\nvar _convert = require(\"./convert\");\n\nvar _convert2 = _interopRequireDefault(_convert);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction reduce(node, precision) {\n  if (node.type === \"MathExpression\") return reduceMathExpression(node, precision);\n  if (node.type === \"Calc\") return reduce(node.value, precision);\n\n  return node;\n}\n\nfunction isEqual(left, right) {\n  return left.type === right.type && left.value === right.value;\n}\n\nfunction isValueType(type) {\n  switch (type) {\n    case 'LengthValue':\n    case 'AngleValue':\n    case 'TimeValue':\n    case 'FrequencyValue':\n    case 'ResolutionValue':\n    case 'EmValue':\n    case 'ExValue':\n    case 'ChValue':\n    case 'RemValue':\n    case 'VhValue':\n    case 'VwValue':\n    case 'VminValue':\n    case 'VmaxValue':\n    case 'PercentageValue':\n    case 'Value':\n      return true;\n  }\n  return false;\n}\n\nfunction convertMathExpression(node, precision) {\n  var nodes = (0, _convert2.default)(node.left, node.right, precision);\n  var left = reduce(nodes.left, precision);\n  var right = reduce(nodes.right, precision);\n\n  if (left.type === \"MathExpression\" && right.type === \"MathExpression\") {\n\n    if (left.operator === '/' && right.operator === '*' || left.operator === '-' && right.operator === '+' || left.operator === '*' && right.operator === '/' || left.operator === '+' && right.operator === '-') {\n\n      if (isEqual(left.right, right.right)) nodes = (0, _convert2.default)(left.left, right.left, precision);else if (isEqual(left.right, right.left)) nodes = (0, _convert2.default)(left.left, right.right, precision);\n\n      left = reduce(nodes.left, precision);\n      right = reduce(nodes.right, precision);\n    }\n  }\n\n  node.left = left;\n  node.right = right;\n  return node;\n}\n\nfunction flip(operator) {\n  return operator === '+' ? '-' : '+';\n}\n\nfunction flipValue(node) {\n  if (isValueType(node.type)) node.value = -node.value;else if (node.type == 'MathExpression') {\n    node.left = flipValue(node.left);\n    node.right = flipValue(node.right);\n  }\n  return node;\n}\n\nfunction reduceAddSubExpression(node, precision) {\n  var _node = node,\n      left = _node.left,\n      right = _node.right,\n      op = _node.operator;\n\n\n  if (left.type === 'CssVariable' || right.type === 'CssVariable') return node;\n\n  // something + 0 => something\n  // something - 0 => something\n  if (right.value === 0) return left;\n\n  // 0 + something => something\n  if (left.value === 0 && op === \"+\") return right;\n\n  // 0 - something => -something\n  if (left.value === 0 && op === \"-\") return flipValue(right);\n\n  // value + value\n  // value - value\n  if (left.type === right.type && isValueType(left.type)) {\n    node = Object.assign({}, left);\n    if (op === \"+\") node.value = left.value + right.value;else node.value = left.value - right.value;\n  }\n\n  // value <op> (expr)\n  if (isValueType(left.type) && (right.operator === '+' || right.operator === '-') && right.type === 'MathExpression') {\n    // value + (value + something) => (value + value) + something\n    // value + (value - something) => (value + value) - something\n    // value - (value + something) => (value - value) - something\n    // value - (value - something) => (value - value) + something\n    if (left.type === right.left.type) {\n      node = Object.assign({}, node);\n      node.left = reduce({\n        type: 'MathExpression',\n        operator: op,\n        left: left,\n        right: right.left\n      }, precision);\n      node.right = right.right;\n      node.operator = op === '-' ? flip(right.operator) : right.operator;\n      return reduce(node, precision);\n    }\n    // value + (something + value) => (value + value) + something\n    // value + (something - value) => (value - value) + something\n    // value - (something + value) => (value - value) - something\n    // value - (something - value) => (value + value) - something\n    else if (left.type === right.right.type) {\n        node = Object.assign({}, node);\n        node.left = reduce({\n          type: 'MathExpression',\n          operator: op === '-' ? flip(right.operator) : right.operator,\n          left: left,\n          right: right.right\n        }, precision);\n        node.right = right.left;\n        return reduce(node, precision);\n      }\n  }\n\n  // (expr) <op> value\n  if (left.type === 'MathExpression' && (left.operator === '+' || left.operator === '-') && isValueType(right.type)) {\n    // (value + something) + value => (value + value) + something\n    // (value - something) + value => (value + value) - something\n    // (value + something) - value => (value - value) + something\n    // (value - something) - value => (value - value) - something\n    if (right.type === left.left.type) {\n      node = Object.assign({}, left);\n      node.left = reduce({\n        type: 'MathExpression',\n        operator: op,\n        left: left.left,\n        right: right\n      }, precision);\n      return reduce(node, precision);\n    }\n    // (something + value) + value => something + (value + value)\n    // (something - value1) + value2 => something - (value2 - value1)\n    // (something + value) - value => something + (value - value)\n    // (something - value) - value => something - (value + value)\n    else if (right.type === left.right.type) {\n        node = Object.assign({}, left);\n        if (left.operator === '-') {\n          node.right = reduce({\n            type: 'MathExpression',\n            operator: op === '-' ? '+' : '-',\n            left: right,\n            right: left.right\n          }, precision);\n          node.operator = op === '-' ? '-' : '+';\n        } else {\n          node.right = reduce({\n            type: 'MathExpression',\n            operator: op,\n            left: left.right,\n            right: right\n          }, precision);\n        }\n        if (node.right.value < 0) {\n          node.right.value *= -1;\n          node.operator = node.operator === '-' ? '+' : '-';\n        }\n        return reduce(node, precision);\n      }\n  }\n  return node;\n}\n\nfunction reduceDivisionExpression(node, precision) {\n  if (!isValueType(node.right.type)) return node;\n\n  if (node.right.type !== 'Value') throw new Error(\"Cannot divide by \\\"\" + node.right.unit + \"\\\", number expected\");\n\n  if (node.right.value === 0) throw new Error('Cannot divide by zero');\n\n  // (expr) / value\n  if (node.left.type === 'MathExpression') {\n    if (isValueType(node.left.left.type) && isValueType(node.left.right.type)) {\n      node.left.left.value /= node.right.value;\n      node.left.right.value /= node.right.value;\n      return reduce(node.left, precision);\n    }\n    return node;\n  }\n  // something / value\n  else if (isValueType(node.left.type)) {\n      node.left.value /= node.right.value;\n      return node.left;\n    }\n  return node;\n}\n\nfunction reduceMultiplicationExpression(node) {\n  // (expr) * value\n  if (node.left.type === 'MathExpression' && node.right.type === 'Value') {\n    if (isValueType(node.left.left.type) && isValueType(node.left.right.type)) {\n      node.left.left.value *= node.right.value;\n      node.left.right.value *= node.right.value;\n      return node.left;\n    }\n  }\n  // something * value\n  else if (isValueType(node.left.type) && node.right.type === 'Value') {\n      node.left.value *= node.right.value;\n      return node.left;\n    }\n    // value * (expr)\n    else if (node.left.type === 'Value' && node.right.type === 'MathExpression') {\n        if (isValueType(node.right.left.type) && isValueType(node.right.right.type)) {\n          node.right.left.value *= node.left.value;\n          node.right.right.value *= node.left.value;\n          return node.right;\n        }\n      }\n      // value * something\n      else if (node.left.type === 'Value' && isValueType(node.right.type)) {\n          node.right.value *= node.left.value;\n          return node.right;\n        }\n  return node;\n}\n\nfunction reduceMathExpression(node, precision) {\n  node = convertMathExpression(node, precision);\n\n  switch (node.operator) {\n    case \"+\":\n    case \"-\":\n      return reduceAddSubExpression(node, precision);\n    case \"/\":\n      return reduceDivisionExpression(node, precision);\n    case \"*\":\n      return reduceMultiplicationExpression(node);\n  }\n  return node;\n}\n\nexports.default = reduce;"]},"metadata":{},"sourceType":"script"}